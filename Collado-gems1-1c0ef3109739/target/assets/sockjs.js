var JSON;JSON||(JSON={}),function(){function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o;return i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o;return i}}function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function f(e){return e<10?"0"+e:e}"use strict",typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver=="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")})}();SockJS=function(){var e=document;var t=window;var n={};var r=function(){};r.prototype.addEventListener=function(e,t){if(!this._listeners){this._listeners={}}if(!(e in this._listeners)){this._listeners[e]=[]}var r=this._listeners[e];if(n.arrIndexOf(r,t)===-1){r.push(t)}return};r.prototype.removeEventListener=function(e,t){if(!(this._listeners&&e in this._listeners)){return}var r=this._listeners[e];var i=n.arrIndexOf(r,t);if(i!==-1){if(r.length>1){this._listeners[e]=r.slice(0,i).concat(r.slice(i+1))}else{delete this._listeners[e]}return}return};r.prototype.dispatchEvent=function(e){var t=e.type;var n=Array.prototype.slice.call(arguments,0);if(this["on"+t]){this["on"+t].apply(this,n)}if(this._listeners&&t in this._listeners){for(var r=0;r<this._listeners[t].length;r++){this._listeners[t][r].apply(this,n)}}};var i=function(e,t){this.type=e;if(typeof t!=="undefined"){for(var n in t){if(!t.hasOwnProperty(n))continue;this[n]=t[n]}}};i.prototype.toString=function(){var e=[];for(var t in this){if(!this.hasOwnProperty(t))continue;var n=this[t];if(typeof n==="function")n="[function]";e.push(t+"="+n)}return"SimpleEvent("+e.join(", ")+")"};var s=function(e){var t=this;t._events=e||[];t._listeners={}};s.prototype.emit=function(e){var t=this;t._verifyType(e);if(t._nuked)return;var n=Array.prototype.slice.call(arguments,1);if(t["on"+e]){t["on"+e].apply(t,n)}if(e in t._listeners){for(var r=0;r<t._listeners[e].length;r++){t._listeners[e][r].apply(t,n)}}};s.prototype.on=function(e,t){var n=this;n._verifyType(e);if(n._nuked)return;if(!(e in n._listeners)){n._listeners[e]=[]}n._listeners[e].push(t)};s.prototype._verifyType=function(e){var t=this;if(n.arrIndexOf(t._events,e)===-1){n.log("Event "+JSON.stringify(e)+" not listed "+JSON.stringify(t._events)+" in "+t)}};s.prototype.nuke=function(){var e=this;e._nuked=true;for(var t=0;t<e._events.length;t++){delete e[e._events[t]]}e._listeners={}};var o="abcdefghijklmnopqrstuvwxyz0123456789_";n.random_string=function(e,t){t=t||o.length;var n,r=[];for(n=0;n<e;n++){r.push(o.substr(Math.floor(Math.random()*t),1))}return r.join("")};n.random_number=function(e){return Math.floor(Math.random()*e)};n.random_number_string=function(e){var t=(""+(e-1)).length;var r=Array(t+1).join("0");return(r+n.random_number(e)).slice(-t)};n.getOrigin=function(e){e+="/";var t=e.split("/").slice(0,3);return t.join("/")};n.isSameOriginUrl=function(e,n){if(!n)n=t.location.href;return e.split("/").slice(0,3).join("/")===n.split("/").slice(0,3).join("/")};n.getParentDomain=function(e){if(/^[0-9.]*$/.test(e))return e;if(/^\[/.test(e))return e;if(!/[.]/.test(e))return e;var t=e.split(".").slice(1);return t.join(".")};n.objectExtend=function(e,t){for(var n in t){if(t.hasOwnProperty(n)){e[n]=t[n]}}return e};var u="_jp";n.polluteGlobalNamespace=function(){if(!(u in t)){t[u]={}}};n.closeFrame=function(e,t){return"c"+JSON.stringify([e,t])};n.userSetCode=function(e){return e===1e3||e>=3e3&&e<=4999};n.countRTO=function(e){var t;if(e>100){t=3*e}else{t=e+200}return t};n.log=function(){if(t.console&&console.log&&console.log.apply){console.log.apply(console,arguments)}};n.bind=function(e,t){if(e.bind){return e.bind(t)}else{return function(){return e.apply(t,arguments)}}};n.flatUrl=function(e){return e.indexOf("?")===-1&&e.indexOf("#")===-1};n.amendUrl=function(t){var r=e.location;if(!t){throw new Error("Wrong url for SockJS")}if(!n.flatUrl(t)){throw new Error("Only basic urls are supported in SockJS")}if(t.indexOf("//")===0){t=r.protocol+t}if(t.indexOf("/")===0){t=r.protocol+"//"+r.host+t}t=t.replace(/[/]+$/,"");return t};n.arrIndexOf=function(e,t){for(var n=0;n<e.length;n++){if(e[n]===t){return n}}return-1};n.arrSkip=function(e,t){var r=n.arrIndexOf(e,t);if(r===-1){return e.slice()}else{var i=e.slice(0,r);return i.concat(e.slice(r+1))}};n.isArray=Array.isArray||function(e){return{}.toString.call(e).indexOf("Array")>=0};n.delay=function(e,t){if(typeof e==="function"){t=e;e=0}return setTimeout(t,e)};var a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f={"\0":"\\u0000","":"\\u0001","":"\\u0002","":"\\u0003","":"\\u0004","":"\\u0005","":"\\u0006","":"\\u0007","\b":"\\b","	":"\\t","\n":"\\n","":"\\u000b","\f":"\\f","\r":"\\r","":"\\u000e","":"\\u000f","":"\\u0010","":"\\u0011","":"\\u0012","":"\\u0013","":"\\u0014","":"\\u0015","":"\\u0016","":"\\u0017","":"\\u0018","":"\\u0019","":"\\u001a","":"\\u001b","":"\\u001c","":"\\u001d","":"\\u001e","":"\\u001f",'"':'\\"',"\\":"\\\\","":"\\u007f","¬Ä":"\\u0080","¬Å":"\\u0081","¬Ç":"\\u0082","¬É":"\\u0083","¬Ñ":"\\u0084","¬Ö":"\\u0085","¬Ü":"\\u0086","¬á":"\\u0087","¬à":"\\u0088","¬â":"\\u0089","¬ä":"\\u008a","¬ã":"\\u008b","¬å":"\\u008c","¬ç":"\\u008d","¬é":"\\u008e","¬è":"\\u008f","¬ê":"\\u0090","¬ë":"\\u0091","¬í":"\\u0092","¬ì":"\\u0093","¬î":"\\u0094","¬ï":"\\u0095","¬ñ":"\\u0096","¬ó":"\\u0097","¬ò":"\\u0098","¬ô":"\\u0099","¬ö":"\\u009a","¬õ":"\\u009b","¬ú":"\\u009c","¬ù":"\\u009d","¬û":"\\u009e","¬ü":"\\u009f","¬≠":"\\u00ad","ÿÄ":"\\u0600","ÿÅ":"\\u0601","ÿÇ":"\\u0602","ÿÉ":"\\u0603","ÿÑ":"\\u0604","‹è":"\\u070f","·û¥":"\\u17b4","·ûµ":"\\u17b5","‚Äå":"\\u200c","‚Äç":"\\u200d","‚Äé":"\\u200e","‚Äè":"\\u200f","\u2028":"\\u2028","\u2029":"\\u2029","‚Ä™":"\\u202a","‚Ä´":"\\u202b","‚Ä¨":"\\u202c","‚Ä≠":"\\u202d","‚ÄÆ":"\\u202e","‚ÄØ":"\\u202f","‚Å†":"\\u2060","‚Å°":"\\u2061","‚Å¢":"\\u2062","‚Å£":"\\u2063","‚Å§":"\\u2064","‚Å•":"\\u2065","‚Å¶":"\\u2066","‚Åß":"\\u2067","‚Å®":"\\u2068","‚Å©":"\\u2069","‚Å™":"\\u206a","‚Å´":"\\u206b","‚Å¨":"\\u206c","‚Å≠":"\\u206d","‚ÅÆ":"\\u206e","‚ÅØ":"\\u206f","Ôªø":"\\ufeff","Ôø∞":"\\ufff0","Ôø±":"\\ufff1","Ôø≤":"\\ufff2","Ôø≥":"\\ufff3","Ôø¥":"\\ufff4","Ôøµ":"\\ufff5","Ôø∂":"\\ufff6","Ôø∑":"\\ufff7","Ôø∏":"\\ufff8","Ôøπ":"\\ufff9","Ôø∫":"\\ufffa","Ôøª":"\\ufffb","Ôøº":"\\ufffc","ÔøΩ":"\\ufffd","Ôøæ":"\\ufffe","Ôøø":"\\uffff"};var l=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,c;var h=JSON&&JSON.stringify||function(e){a.lastIndex=0;if(a.test(e)){e=e.replace(a,function(e){return f[e]})}return'"'+e+'"'};var p=function(e){var t;var n={};var r=[];for(t=0;t<65536;t++){r.push(String.fromCharCode(t))}e.lastIndex=0;r.join("").replace(e,function(e){n[e]="\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4);return""});e.lastIndex=0;return n};n.quote=function(e){var t=h(e);l.lastIndex=0;if(!l.test(t)){return t}if(!c)c=p(l);return t.replace(l,function(e){return c[e]})};var d=["websocket","xdr-streaming","xhr-streaming","iframe-eventsource","iframe-htmlfile","xdr-polling","xhr-polling","iframe-xhr-polling","jsonp-polling"];n.probeProtocols=function(){var e={};for(var t=0;t<d.length;t++){var n=d[t];e[n]=T[n]&&T[n].enabled()}return e};n.detectProtocols=function(e,t,n){var r={},i=[];if(!t)t=d;for(var s=0;s<t.length;s++){var o=t[s];r[o]=e[o]}var u=function(e){var t=e.shift();if(r[t]){i.push(t)}else{if(e.length>0){u(e)}}};if(n.websocket!==false){u(["websocket"])}if(r["xhr-streaming"]&&!n.null_origin){i.push("xhr-streaming")}else{if(r["xdr-streaming"]&&!n.cookie_needed&&!n.null_origin){i.push("xdr-streaming")}else{u(["iframe-eventsource","iframe-htmlfile"])}}if(r["xhr-polling"]&&!n.null_origin){i.push("xhr-polling")}else{if(r["xdr-polling"]&&!n.cookie_needed&&!n.null_origin){i.push("xdr-polling")}else{u(["iframe-xhr-polling","jsonp-polling"])}}return i};var v="_sockjs_global";n.createHook=function(){var e="a"+n.random_string(8);if(!(v in t)){var r={};t[v]=function(e){if(!(e in r)){r[e]={id:e,del:function(){delete r[e]}}}return r[e]}}return t[v](e)};n.attachMessage=function(e){n.attachEvent("message",e)};n.attachEvent=function(n,r){if(typeof t.addEventListener!=="undefined"){t.addEventListener(n,r,false)}else{e.attachEvent("on"+n,r);t.attachEvent("on"+n,r)}};n.detachMessage=function(e){n.detachEvent("message",e)};n.detachEvent=function(n,r){if(typeof t.addEventListener!=="undefined"){t.removeEventListener(n,r,false)}else{e.detachEvent("on"+n,r);t.detachEvent("on"+n,r)}};var m={};var g=false;var y=function(){for(var e in m){m[e]();delete m[e]}};var b=function(){if(g)return;g=true;y()};n.attachEvent("unload",b);n.unload_add=function(e){var t=n.random_string(8);m[t]=e;if(g){n.delay(y)}return t};n.unload_del=function(e){if(e in m)delete m[e]};n.createIframe=function(t,r){var i=e.createElement("iframe");var s,o;var u=function(){clearTimeout(s);try{i.onload=null}catch(e){}i.onerror=null};var a=function(){if(i){u();setTimeout(function(){if(i){i.parentNode.removeChild(i)}i=null},0);n.unload_del(o)}};var f=function(e){if(i){a();r(e)}};var l=function(e,t){try{if(i&&i.contentWindow){i.contentWindow.postMessage(e,t)}}catch(n){}};i.src=t;i.style.display="none";i.style.position="absolute";i.onerror=function(){f("onerror")};i.onload=function(){clearTimeout(s);s=setTimeout(function(){f("onload timeout")},2e3)};e.body.appendChild(i);s=setTimeout(function(){f("timeout")},15e3);o=n.unload_add(a);return{post:l,cleanup:a,loaded:u}};n.createHtmlfile=function(e,r){var i=new ActiveXObject("htmlfile");var s,o;var a;var f=function(){clearTimeout(s)};var l=function(){if(i){f();n.unload_del(o);a.parentNode.removeChild(a);a=i=null;CollectGarbage()}};var c=function(e){if(i){l();r(e)}};var h=function(e,t){try{if(a&&a.contentWindow){a.contentWindow.postMessage(e,t)}}catch(n){}};i.open();i.write("<html><s"+"cript>"+'document.domain="'+document.domain+'";'+"</s"+"cript></html>");i.close();i.parentWindow[u]=t[u];var p=i.createElement("div");i.body.appendChild(p);a=i.createElement("iframe");p.appendChild(a);a.src=e;s=setTimeout(function(){c("timeout")},15e3);o=n.unload_add(l);return{post:h,cleanup:l,loaded:f}};var w=function(){};w.prototype=new s(["chunk","finish"]);w.prototype._start=function(e,r,i,s){var o=this;try{o.xhr=new XMLHttpRequest}catch(u){}if(!o.xhr){try{o.xhr=new t.ActiveXObject("Microsoft.XMLHTTP")}catch(u){}}if(t.ActiveXObject||t.XDomainRequest){r+=(r.indexOf("?")===-1?"?":"&")+"t="+ +(new Date)}o.unload_ref=n.unload_add(function(){o._cleanup(true)});try{o.xhr.open(e,r,true)}catch(a){o.emit("finish",0,"");o._cleanup();return}if(!s||!s.no_credentials){o.xhr.withCredentials="true"}if(s&&s.headers){for(var f in s.headers){o.xhr.setRequestHeader(f,s.headers[f])}}o.xhr.onreadystatechange=function(){if(o.xhr){var e=o.xhr;switch(e.readyState){case 3:try{var t=e.status;var n=e.responseText}catch(e){}if(t===1223)t=204;if(n&&n.length>0){o.emit("chunk",t,n)}break;case 4:var t=e.status;if(t===1223)t=204;o.emit("finish",t,e.responseText);o._cleanup(false);break}}};o.xhr.send(i)};w.prototype._cleanup=function(e){var t=this;if(!t.xhr)return;n.unload_del(t.unload_ref);t.xhr.onreadystatechange=function(){};if(e){try{t.xhr.abort()}catch(r){}}t.unload_ref=t.xhr=null};w.prototype.close=function(){var e=this;e.nuke();e._cleanup(true)};var E=n.XHRCorsObject=function(){var e=this,t=arguments;n.delay(function(){e._start.apply(e,t)})};E.prototype=new w;var S=n.XHRLocalObject=function(e,t,r){var i=this;n.delay(function(){i._start(e,t,r,{no_credentials:true})})};S.prototype=new w;var x=n.XDRObject=function(e,t,r){var i=this;n.delay(function(){i._start(e,t,r)})};x.prototype=new s(["chunk","finish"]);x.prototype._start=function(e,t,r){var i=this;var s=new XDomainRequest;t+=(t.indexOf("?")===-1?"?":"&")+"t="+ +(new Date);var o=s.ontimeout=s.onerror=function(){i.emit("finish",0,"");i._cleanup(false)};s.onprogress=function(){i.emit("chunk",200,s.responseText)};s.onload=function(){i.emit("finish",200,s.responseText);i._cleanup(false)};i.xdr=s;i.unload_ref=n.unload_add(function(){i._cleanup(true)});try{i.xdr.open(e,t);i.xdr.send(r)}catch(u){o()}};x.prototype._cleanup=function(e){var t=this;if(!t.xdr)return;n.unload_del(t.unload_ref);t.xdr.ontimeout=t.xdr.onerror=t.xdr.onprogress=t.xdr.onload=null;if(e){try{t.xdr.abort()}catch(r){}}t.unload_ref=t.xdr=null};x.prototype.close=function(){var e=this;e.nuke();e._cleanup(true)};n.isXHRCorsCapable=function(){if(t.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest){return 1}if(t.XDomainRequest&&e.domain){return 2}if(j.enabled()){return 3}return 4};var T=function(e,r,i){if(this===t){return new T(e,r,i)}var s=this,o;s._options={devel:false,debug:false,protocols_whitelist:[],info:undefined,rtt:undefined};if(i){n.objectExtend(s._options,i)}s._base_url=n.amendUrl(e);s._server=s._options.server||n.random_number_string(1e3);if(s._options.protocols_whitelist&&s._options.protocols_whitelist.length){o=s._options.protocols_whitelist}else{if(typeof r==="string"&&r.length>0){o=[r]}else if(n.isArray(r)){o=r}else{o=null}if(o){s._debug('Deprecated API: Use "protocols_whitelist" option '+"instead of supplying protocol list as a second "+"parameter to SockJS constructor.")}}s._protocols=[];s.protocol=null;s.readyState=T.CONNECTING;s._ir=W(s._base_url);s._ir.onfinish=function(e,t){s._ir=null;if(e){if(s._options.info){e=n.objectExtend(e,s._options.info)}if(s._options.rtt){t=s._options.rtt}s._applyInfo(e,t,o);s._didClose()}else{s._didClose(1002,"Can't connect to server",true)}}};T.prototype=new r;T.version="0.3.4";T.CONNECTING=0;T.OPEN=1;T.CLOSING=2;T.CLOSED=3;T.prototype._debug=function(){if(this._options.debug)n.log.apply(n,arguments)};T.prototype._dispatchOpen=function(){var e=this;if(e.readyState===T.CONNECTING){if(e._transport_tref){clearTimeout(e._transport_tref);e._transport_tref=null}e.readyState=T.OPEN;e.dispatchEvent(new i("open"))}else{e._didClose(1006,"Server lost session")}};T.prototype._dispatchMessage=function(e){var t=this;if(t.readyState!==T.OPEN)return;t.dispatchEvent(new i("message",{data:e}))};T.prototype._dispatchHeartbeat=function(e){var t=this;if(t.readyState!==T.OPEN)return;t.dispatchEvent(new i("heartbeat",{}))};T.prototype._didClose=function(e,t,r){var s=this;if(s.readyState!==T.CONNECTING&&s.readyState!==T.OPEN&&s.readyState!==T.CLOSING)throw new Error("INVALID_STATE_ERR");if(s._ir){s._ir.nuke();s._ir=null}if(s._transport){s._transport.doCleanup();s._transport=null}var o=new i("close",{code:e,reason:t,wasClean:n.userSetCode(e)});if(!n.userSetCode(e)&&s.readyState===T.CONNECTING&&!r){if(s._try_next_protocol(o)){return}o=new i("close",{code:2e3,reason:"All transports failed",wasClean:false,last_event:o})}s.readyState=T.CLOSED;n.delay(function(){s.dispatchEvent(o)})};T.prototype._didMessage=function(e){var t=this;var n=e.slice(0,1);switch(n){case"o":t._dispatchOpen();break;case"a":var r=JSON.parse(e.slice(1)||"[]");for(var i=0;i<r.length;i++){t._dispatchMessage(r[i])}break;case"m":var r=JSON.parse(e.slice(1)||"null");t._dispatchMessage(r);break;case"c":var r=JSON.parse(e.slice(1)||"[]");t._didClose(r[0],r[1]);break;case"h":t._dispatchHeartbeat();break}};T.prototype._try_next_protocol=function(t){var r=this;if(r.protocol){r._debug("Closed transport:",r.protocol,""+t);r.protocol=null}if(r._transport_tref){clearTimeout(r._transport_tref);r._transport_tref=null}while(1){var i=r.protocol=r._protocols.shift();if(!i){return false}if(T[i]&&T[i].need_body===true&&(!e.body||typeof e.readyState!=="undefined"&&e.readyState!=="complete")){r._protocols.unshift(i);r.protocol="waiting-for-load";n.attachEvent("load",function(){r._try_next_protocol()});return true}if(!T[i]||!T[i].enabled(r._options)){r._debug("Skipping transport:",i)}else{var s=T[i].roundTrips||1;var o=(r._options.rto||0)*s||5e3;r._transport_tref=n.delay(o,function(){if(r.readyState===T.CONNECTING){r._didClose(2007,"Transport timeouted")}});var u=n.random_string(8);var a=r._base_url+"/"+r._server+"/"+u;r._debug("Opening transport:",i," url:"+a," RTO:"+r._options.rto);r._transport=new T[i](r,a,r._base_url);return true}}};T.prototype.close=function(e,t){var r=this;if(e&&!n.userSetCode(e))throw new Error("INVALID_ACCESS_ERR");if(r.readyState!==T.CONNECTING&&r.readyState!==T.OPEN){return false}r.readyState=T.CLOSING;r._didClose(e||1e3,t||"Normal closure");return true};T.prototype.send=function(e){var t=this;if(t.readyState===T.CONNECTING)throw new Error("INVALID_STATE_ERR");if(t.readyState===T.OPEN){t._transport.doSend(n.quote(""+e))}return true};T.prototype._applyInfo=function(t,r,i){var s=this;s._options.info=t;s._options.rtt=r;s._options.rto=n.countRTO(r);s._options.info.null_origin=!e.domain;var o=n.probeProtocols();s._protocols=n.detectProtocols(o,i,t)};var N=T.websocket=function(e,r){var i=this;var s=r+"/websocket";if(s.slice(0,5)==="https"){s="wss"+s.slice(5)}else{s="ws"+s.slice(4)}i.ri=e;i.url=s;var o=t.WebSocket||t.MozWebSocket;i.ws=new o(i.url);i.ws.onmessage=function(e){i.ri._didMessage(e.data)};i.unload_ref=n.unload_add(function(){i.ws.close()});i.ws.onclose=function(){i.ri._didMessage(n.closeFrame(1006,"WebSocket connection broken"))}};N.prototype.doSend=function(e){this.ws.send("["+e+"]")};N.prototype.doCleanup=function(){var e=this;var t=e.ws;if(t){t.onmessage=t.onclose=null;t.close();n.unload_del(e.unload_ref);e.unload_ref=e.ri=e.ws=null}};N.enabled=function(){return!!(t.WebSocket||t.MozWebSocket)};N.roundTrips=2;var C=function(){};C.prototype.send_constructor=function(e){var t=this;t.send_buffer=[];t.sender=e};C.prototype.doSend=function(e){var t=this;t.send_buffer.push(e);if(!t.send_stop){t.send_schedule()}};C.prototype.send_schedule_wait=function(){var e=this;var t;e.send_stop=function(){e.send_stop=null;clearTimeout(t)};t=n.delay(25,function(){e.send_stop=null;e.send_schedule()})};C.prototype.send_schedule=function(){var e=this;if(e.send_buffer.length>0){var t="["+e.send_buffer.join(",")+"]";e.send_stop=e.sender(e.trans_url,t,function(t,n){e.send_stop=null;if(t===false){e.ri._didClose(1006,"Sending error "+n)}else{e.send_schedule_wait()}});e.send_buffer=[]}};C.prototype.send_destructor=function(){var e=this;if(e._send_stop){e._send_stop()}e._send_stop=null};var k=function(t,r,i){var s=this;if(!("_send_form"in s)){var o=s._send_form=e.createElement("form");var u=s._send_area=e.createElement("textarea");u.name="d";o.style.display="none";o.style.position="absolute";o.method="POST";o.enctype="application/x-www-form-urlencoded";o.acceptCharset="UTF-8";o.appendChild(u);e.body.appendChild(o)}var o=s._send_form;var u=s._send_area;var a="a"+n.random_string(8);o.target=a;o.action=t+"/jsonp_send?i="+a;var f;try{f=e.createElement('<iframe name="'+a+'">')}catch(l){f=e.createElement("iframe");f.name=a}f.id=a;o.appendChild(f);f.style.display="none";try{u.value=r}catch(c){n.log("Your browser is seriously broken. Go home! "+c.message)}o.submit();var h=function(e){if(!f.onerror)return;f.onreadystatechange=f.onerror=f.onload=null;n.delay(500,function(){f.parentNode.removeChild(f);f=null});u.value="";i(true)};f.onerror=f.onload=h;f.onreadystatechange=function(e){if(f.readyState=="complete")h()};return h};var L=function(e){return function(t,n,r){var i=new e("POST",t+"/xhr_send",n);i.onfinish=function(e,t){r(e===200||e===204,"http status "+e)};return function(e){r(false,e)}}};var A=function(t,r){var i;var s=e.createElement("script");var o;var u=function(e){if(o){o.parentNode.removeChild(o);o=null}if(s){clearTimeout(i);s.parentNode.removeChild(s);s.onreadystatechange=s.onerror=s.onload=s.onclick=null;s=null;r(e);r=null}};var a=false;var f=null;s.id="a"+n.random_string(8);s.src=t;s.type="text/javascript";s.charset="UTF-8";s.onerror=function(e){if(!f){f=setTimeout(function(){if(!a){u(n.closeFrame(1006,"JSONP script loaded abnormally (onerror)"))}},1e3)}};s.onload=function(e){u(n.closeFrame(1006,"JSONP script loaded abnormally (onload)"))};s.onreadystatechange=function(e){if(/loaded|closed/.test(s.readyState)){if(s&&s.htmlFor&&s.onclick){a=true;try{s.onclick()}catch(t){}}if(s){u(n.closeFrame(1006,"JSONP script loaded abnormally (onreadystatechange)"))}}};if(typeof s.async==="undefined"&&e.attachEvent){if(!/opera/i.test(navigator.userAgent)){try{s.htmlFor=s.id;s.event="onclick"}catch(l){}s.async=true}else{o=e.createElement("script");o.text="try{var a = document.getElementById('"+s.id+"'); if(a)a.onerror();}catch(x){};";s.async=o.async=false}}if(typeof s.async!=="undefined"){s.async=true}i=setTimeout(function(){u(n.closeFrame(1006,"JSONP script loaded abnormally (timeout)"))},35e3);var c=e.getElementsByTagName("head")[0];c.insertBefore(s,c.firstChild);if(o){c.insertBefore(o,c.firstChild)}return u};var O=T["jsonp-polling"]=function(e,t){n.polluteGlobalNamespace();var r=this;r.ri=e;r.trans_url=t;r.send_constructor(k);r._schedule_recv()};O.prototype=new C;O.prototype._schedule_recv=function(){var e=this;var t=function(t){e._recv_stop=null;if(t){if(!e._is_closing){e.ri._didMessage(t)}}if(!e._is_closing){e._schedule_recv()}};e._recv_stop=M(e.trans_url+"/jsonp",A,t)};O.enabled=function(){return true};O.need_body=true;O.prototype.doCleanup=function(){var e=this;e._is_closing=true;if(e._recv_stop){e._recv_stop()}e.ri=e._recv_stop=null;e.send_destructor()};var M=function(e,r,i){var s="a"+n.random_string(6);var o=e+"?c="+escape(u+"."+s);var a=0;var f=function(e){switch(a){case 0:delete t[u][s];i(e);break;case 1:i(e);a=2;break;case 2:delete t[u][s];break}};var l=r(o,f);t[u][s]=l;var c=function(){if(t[u][s]){a=1;t[u][s](n.closeFrame(1e3,"JSONP user aborted read"))}};return c};var _=function(){};_.prototype=new C;_.prototype.run=function(e,t,n,r,i){var s=this;s.ri=e;s.trans_url=t;s.send_constructor(L(i));s.poll=new Y(e,r,t+n,i)};_.prototype.doCleanup=function(){var e=this;if(e.poll){e.poll.abort();e.poll=null}};var D=T["xhr-streaming"]=function(e,t){this.run(e,t,"/xhr_streaming",rt,n.XHRCorsObject)};D.prototype=new _;D.enabled=function(){return t.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest&&!/opera/i.test(navigator.userAgent)};D.roundTrips=2;D.need_body=true;var P=T["xdr-streaming"]=function(e,t){this.run(e,t,"/xhr_streaming",rt,n.XDRObject)};P.prototype=new _;P.enabled=function(){return!!t.XDomainRequest};P.roundTrips=2;var H=T["xhr-polling"]=function(e,t){this.run(e,t,"/xhr",rt,n.XHRCorsObject)};H.prototype=new _;H.enabled=D.enabled;H.roundTrips=2;var B=T["xdr-polling"]=function(e,t){this.run(e,t,"/xhr",rt,n.XDRObject)};B.prototype=new _;B.enabled=P.enabled;B.roundTrips=2;var j=function(){};j.prototype.i_constructor=function(e,t,r){var i=this;i.ri=e;i.origin=n.getOrigin(r);i.base_url=r;i.trans_url=t;var s=r+"/iframe.html";if(i.ri._options.devel){s+="?t="+ +(new Date)}i.window_id=n.random_string(8);s+="#"+i.window_id;i.iframeObj=n.createIframe(s,function(e){i.ri._didClose(1006,"Unable to load an iframe ("+e+")")});i.onmessage_cb=n.bind(i.onmessage,i);n.attachMessage(i.onmessage_cb)};j.prototype.doCleanup=function(){var e=this;if(e.iframeObj){n.detachMessage(e.onmessage_cb);try{if(e.iframeObj.iframe.contentWindow){e.postMessage("c")}}catch(t){}e.iframeObj.cleanup();e.iframeObj=null;e.onmessage_cb=e.iframeObj=null}};j.prototype.onmessage=function(e){var t=this;if(e.origin!==t.origin)return;var n=e.data.slice(0,8);var r=e.data.slice(8,9);var i=e.data.slice(9);if(n!==t.window_id)return;switch(r){case"s":t.iframeObj.loaded();t.postMessage("s",JSON.stringify([T.version,t.protocol,t.trans_url,t.base_url]));break;case"t":t.ri._didMessage(i);break}};j.prototype.postMessage=function(e,t){var n=this;n.iframeObj.post(n.window_id+e+(t||""),n.origin)};j.prototype.doSend=function(e){this.postMessage("m",e)};j.enabled=function(){var e=navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Konqueror")!==-1;return(typeof t.postMessage==="function"||typeof t.postMessage==="object")&&!e};var F;var I=function(e,r){if(parent!==t){parent.postMessage(F+e+(r||""),"*")}else{n.log("Can't postMessage, no parent window.",e,r)}};var q=function(){};q.prototype._didClose=function(e,t){I("t",n.closeFrame(e,t))};q.prototype._didMessage=function(e){I("t",e)};q.prototype._doSend=function(e){this._transport.doSend(e)};q.prototype._doCleanup=function(){this._transport.doCleanup()};n.parent_origin=undefined;T.bootstrap_iframe=function(){var r;F=e.location.hash.slice(1);var i=function(e){if(e.source!==parent)return;if(typeof n.parent_origin==="undefined")n.parent_origin=e.origin;if(e.origin!==n.parent_origin)return;var i=e.data.slice(0,8);var s=e.data.slice(8,9);var o=e.data.slice(9);if(i!==F)return;switch(s){case"s":var u=JSON.parse(o);var a=u[0];var f=u[1];var l=u[2];var c=u[3];if(a!==T.version){n.log("Incompatibile SockJS! Main site uses:"+' "'+a+'", the iframe:'+' "'+T.version+'".')}if(!n.flatUrl(l)||!n.flatUrl(c)){n.log("Only basic urls are supported in SockJS");return}if(!n.isSameOriginUrl(l)||!n.isSameOriginUrl(c)){n.log("Can't connect to different domain from within an "+"iframe. ("+JSON.stringify([t.location.href,l,c])+")");return}r=new q;r._transport=new q[f](r,l,c);break;case"m":r._doSend(o);break;case"c":if(r)r._doCleanup();r=null;break}};n.attachMessage(i);I("s")};var R=function(e,t){var r=this;n.delay(function(){r.doXhr(e,t)})};R.prototype=new s(["finish"]);R.prototype.doXhr=function(e,t){var r=this;var i=(new Date).getTime();var s=new t("GET",e+"/info");var o=n.delay(8e3,function(){s.ontimeout()});s.onfinish=function(e,t){clearTimeout(o);o=null;if(e===200){var n=(new Date).getTime()-i;var s=JSON.parse(t);if(typeof s!=="object")s={};r.emit("finish",s,n)}else{r.emit("finish")}};s.ontimeout=function(){s.close();r.emit("finish")}};var U=function(t){var r=this;var i=function(){var e=new j;e.protocol="w-iframe-info-receiver";var n=function(t){if(typeof t==="string"&&t.substr(0,1)==="m"){var n=JSON.parse(t.substr(1));var i=n[0],s=n[1];r.emit("finish",i,s)}else{r.emit("finish")}e.doCleanup();e=null};var i={_options:{},_didClose:n,_didMessage:n};e.i_constructor(i,t,t)};if(!e.body){n.attachEvent("load",i)}else{i()}};U.prototype=new s(["finish"]);var z=function(){var e=this;n.delay(function(){e.emit("finish",{},2e3)})};z.prototype=new s(["finish"]);var W=function(e){if(n.isSameOriginUrl(e)){return new R(e,n.XHRLocalObject)}switch(n.isXHRCorsCapable()){case 1:return new R(e,n.XHRLocalObject);case 2:return new R(e,n.XDRObject);case 3:return new U(e);default:return new z}};var X=q["w-iframe-info-receiver"]=function(e,t,r){var i=new R(r,n.XHRLocalObject);i.onfinish=function(t,n){e._didMessage("m"+JSON.stringify([t,n]));e._didClose()}};X.prototype.doCleanup=function(){};var V=T["iframe-eventsource"]=function(){var e=this;e.protocol="w-iframe-eventsource";e.i_constructor.apply(e,arguments)};V.prototype=new j;V.enabled=function(){return"EventSource"in t&&j.enabled()};V.need_body=true;V.roundTrips=3;var $=q["w-iframe-eventsource"]=function(e,t){this.run(e,t,"/eventsource",Z,n.XHRLocalObject)};$.prototype=new _;var J=T["iframe-xhr-polling"]=function(){var e=this;e.protocol="w-iframe-xhr-polling";e.i_constructor.apply(e,arguments)};J.prototype=new j;J.enabled=function(){return t.XMLHttpRequest&&j.enabled()};J.need_body=true;J.roundTrips=3;var K=q["w-iframe-xhr-polling"]=function(e,t){this.run(e,t,"/xhr",rt,n.XHRLocalObject)};K.prototype=new _;var Q=T["iframe-htmlfile"]=function(){var e=this;e.protocol="w-iframe-htmlfile";e.i_constructor.apply(e,arguments)};Q.prototype=new j;Q.enabled=function(){return j.enabled()};Q.need_body=true;Q.roundTrips=3;var G=q["w-iframe-htmlfile"]=function(e,t){this.run(e,t,"/htmlfile",nt,n.XHRLocalObject)};G.prototype=new _;var Y=function(e,t,n,r){var i=this;i.ri=e;i.Receiver=t;i.recv_url=n;i.AjaxObject=r;i._scheduleRecv()};Y.prototype._scheduleRecv=function(){var e=this;var t=e.poll=new e.Receiver(e.recv_url,e.AjaxObject);var n=0;t.onmessage=function(t){n+=1;e.ri._didMessage(t.data)};t.onclose=function(n){e.poll=t=t.onmessage=t.onclose=null;if(!e.poll_is_closing){if(n.reason==="permanent"){e.ri._didClose(1006,"Polling error ("+n.reason+")")}else{e._scheduleRecv()}}}};Y.prototype.abort=function(){var e=this;e.poll_is_closing=true;if(e.poll){e.poll.abort()}};var Z=function(e){var t=this;var r=new EventSource(e);r.onmessage=function(e){t.dispatchEvent(new i("message",{data:unescape(e.data)}))};t.es_close=r.onerror=function(e,s){var o=s?"user":r.readyState!==2?"network":"permanent";t.es_close=r.onmessage=r.onerror=null;r.close();r=null;n.delay(200,function(){t.dispatchEvent(new i("close",{reason:o}))})}};Z.prototype=new r;Z.prototype.abort=function(){var e=this;if(e.es_close){e.es_close({},true)}};var et;var tt=function(){if(et===undefined){if("ActiveXObject"in t){try{et=!!(new ActiveXObject("htmlfile"))}catch(e){}}else{et=false}}return et};var nt=function(e){var r=this;n.polluteGlobalNamespace();r.id="a"+n.random_string(6,26);e+=(e.indexOf("?")===-1?"?":"&")+"c="+escape(u+"."+r.id);var s=tt()?n.createHtmlfile:n.createIframe;var o;t[u][r.id]={start:function(){o.loaded()},message:function(e){r.dispatchEvent(new i("message",{data:e}))},stop:function(){r.iframe_close({},"network")}};r.iframe_close=function(e,n){o.cleanup();r.iframe_close=o=null;delete t[u][r.id];r.dispatchEvent(new i("close",{reason:n}))};o=s(e,function(e){r.iframe_close({},"permanent")})};nt.prototype=new r;nt.prototype.abort=function(){var e=this;if(e.iframe_close){e.iframe_close({},"user")}};var rt=function(e,t){var n=this;var r=0;n.xo=new t("POST",e,null);n.xo.onchunk=function(e,t){if(e!==200)return;while(1){var s=t.slice(r);var o=s.indexOf("\n");if(o===-1)break;r+=o+1;var u=s.slice(0,o);n.dispatchEvent(new i("message",{data:u}))}};n.xo.onfinish=function(e,t){n.xo.onchunk(e,t);n.xo=null;var r=e===200?"network":"permanent";n.dispatchEvent(new i("close",{reason:r}))}};rt.prototype=new r;rt.prototype.abort=function(){var e=this;if(e.xo){e.xo.close();e.dispatchEvent(new i("close",{reason:"user"}));e.xo=null}};T.getUtils=function(){return n};T.getIframeTransport=function(){return j};return T}();if("_sockjs_onload"in window)setTimeout(_sockjs_onload,1);if(typeof define==="function"&&define.amd){define("sockjs",[],function(){return SockJS})}